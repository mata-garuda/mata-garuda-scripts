SET FOREIGN_KEY_CHECKS=0;

-- ----------------------------
-- Table structure for annual_event_aggregation
-- ----------------------------
DROP TABLE IF EXISTS `annual_event_aggregation`;
CREATE TABLE `annual_event_aggregation` (
  `month` varchar(2) CHARACTER SET utf8mb4 NOT NULL,
  `sid` int(11) NOT NULL,
  `ip_src` int(20) unsigned NOT NULL,
  `ip_dst` int(20) unsigned NOT NULL,
  `signature` int(5) NOT NULL,
  `signature_name` varchar(100) NOT NULL,
  `signature_priority` int(2) NOT NULL,
  `protocol` int(5) NOT NULL,
  `s_port` int(11) NOT NULL,
  `d_port` int(11) NOT NULL,
  `counter` decimal(43,0) unsigned DEFAULT NULL,
  UNIQUE KEY `annual_event_aggregation_idx` (`month`,`sid`,`ip_src`,`ip_dst`,`signature`,`signature_name`,`signature_priority`,`protocol`,`s_port`,`d_port`,`counter`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for daily_event_aggregation
-- ----------------------------
DROP TABLE IF EXISTS `daily_event_aggregation`;
CREATE TABLE `daily_event_aggregation` (
  `date` date NOT NULL,
  `hour` int(2) NOT NULL,
  `sid` int(11) NOT NULL,
  `ip_src` int(20) unsigned NOT NULL,
  `ip_dst` int(20) unsigned NOT NULL,
  `signature` int(5) NOT NULL,
  `signature_name` varchar(100) NOT NULL,
  `signature_priority` int(2) NOT NULL,
  `protocol` int(5) NOT NULL,
  `s_port` int(11) NOT NULL,
  `d_port` int(11) NOT NULL,
  `counter` int(21) unsigned NOT NULL DEFAULT '0',
  UNIQUE KEY `daily_event_agregation_idx` (`date`,`hour`,`sid`,`ip_src`,`ip_dst`,`signature`,`signature_name`,`signature_priority`,`protocol`,`s_port`,`d_port`,`counter`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for event
-- ----------------------------
DROP TABLE IF EXISTS `event`;
CREATE TABLE `event` (
  `long_date` datetime NOT NULL,
  `code` varchar(12) DEFAULT NULL,
  `cid` int(11) DEFAULT NULL,
  `sid` int(11) DEFAULT NULL,
  `signature` int(11) DEFAULT NULL,
  `ip_src` bigint(20) DEFAULT NULL,
  `ip_dst` bigint(20) DEFAULT NULL,
  `tcp_sport` int(11) DEFAULT NULL,
  `tcp_dport` int(11) DEFAULT NULL,
  `udp_sport` int(11) DEFAULT NULL,
  `udp_dport` int(11) DEFAULT NULL,
  `signature_name` varchar(100) DEFAULT NULL,
  `signature_priority` int(11) DEFAULT NULL,
  `protocol` int(11) DEFAULT NULL,
  `detail` tinyint(1) DEFAULT NULL,
  KEY `INDEX_LONG_DATE_EVENT` (`long_date`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=latin1

PARTITION BY RANGE ( TO_DAYS(long_date))
(PARTITION p20160325 VALUES LESS THAN (736414) ENGINE = InnoDB,
 PARTITION p20160326 VALUES LESS THAN (736415) ENGINE = InnoDB,
 PARTITION p20160327 VALUES LESS THAN (736416) ENGINE = InnoDB,
 PARTITION p20160328 VALUES LESS THAN (736417) ENGINE = InnoDB,
 PARTITION p20160329 VALUES LESS THAN (736418) ENGINE = InnoDB,
 PARTITION p20160330 VALUES LESS THAN (736419) ENGINE = InnoDB,
 PARTITION p20160331 VALUES LESS THAN (736420) ENGINE = InnoDB,
 PARTITION p20160401 VALUES LESS THAN (736421) ENGINE = InnoDB,
 PARTITION p20160402 VALUES LESS THAN (736422) ENGINE = InnoDB,
 PARTITION p20160403 VALUES LESS THAN (736423) ENGINE = InnoDB,
 PARTITION p20160404 VALUES LESS THAN (736424) ENGINE = InnoDB,
 PARTITION p20160405 VALUES LESS THAN (736425) ENGINE = InnoDB,
 PARTITION p20160406 VALUES LESS THAN (736426) ENGINE = InnoDB,
 PARTITION p20160407 VALUES LESS THAN (736427) ENGINE = InnoDB,
 PARTITION p20160408 VALUES LESS THAN (736428) ENGINE = InnoDB,
 PARTITION p20160409 VALUES LESS THAN (736429) ENGINE = InnoDB,
 PARTITION p20160410 VALUES LESS THAN (736430) ENGINE = InnoDB,
 PARTITION p20160411 VALUES LESS THAN (736431) ENGINE = InnoDB,
 PARTITION p20160412 VALUES LESS THAN (736432) ENGINE = InnoDB,
 PARTITION p20160413 VALUES LESS THAN (736433) ENGINE = InnoDB,
 PARTITION p20160414 VALUES LESS THAN (736434) ENGINE = InnoDB,
 PARTITION p20160415 VALUES LESS THAN (736435) ENGINE = InnoDB,
 PARTITION p20160416 VALUES LESS THAN (736436) ENGINE = InnoDB,
 PARTITION p20160417 VALUES LESS THAN (736437) ENGINE = InnoDB,
 PARTITION p20160418 VALUES LESS THAN (736438) ENGINE = InnoDB,
 PARTITION p20160419 VALUES LESS THAN (736439) ENGINE = InnoDB,
 PARTITION p20160420 VALUES LESS THAN (736440) ENGINE = InnoDB,
 PARTITION p20160421 VALUES LESS THAN (736441) ENGINE = InnoDB,
 PARTITION p20160422 VALUES LESS THAN (736442) ENGINE = InnoDB,
 PARTITION p20160423 VALUES LESS THAN (736443) ENGINE = InnoDB,
 PARTITION p20160424 VALUES LESS THAN (736444) ENGINE = InnoDB,
 PARTITION p20160425 VALUES LESS THAN (736445) ENGINE = InnoDB,
 PARTITION p20160426 VALUES LESS THAN (736446) ENGINE = InnoDB,
 PARTITION p20160427 VALUES LESS THAN (736447) ENGINE = InnoDB,
 PARTITION p20160428 VALUES LESS THAN (736448) ENGINE = InnoDB,
 PARTITION p20160429 VALUES LESS THAN (736449) ENGINE = InnoDB,
 PARTITION p20160430 VALUES LESS THAN (736450) ENGINE = InnoDB,
 PARTITION p20160501 VALUES LESS THAN (736451) ENGINE = InnoDB,
 PARTITION p20160502 VALUES LESS THAN (736452) ENGINE = InnoDB,
 PARTITION p20160503 VALUES LESS THAN (736453) ENGINE = InnoDB,
 PARTITION p20160504 VALUES LESS THAN (736454) ENGINE = InnoDB,
 PARTITION p20160505 VALUES LESS THAN (736455) ENGINE = InnoDB,
 PARTITION p20160506 VALUES LESS THAN (736456) ENGINE = InnoDB,
 PARTITION p20160507 VALUES LESS THAN (736457) ENGINE = InnoDB,
 PARTITION p20160508 VALUES LESS THAN (736458) ENGINE = InnoDB,
 PARTITION p20160509 VALUES LESS THAN (736459) ENGINE = InnoDB,
 PARTITION p20160510 VALUES LESS THAN (736460) ENGINE = InnoDB,
 PARTITION p20160511 VALUES LESS THAN (736461) ENGINE = InnoDB,
 PARTITION p20160512 VALUES LESS THAN (736462) ENGINE = InnoDB,
 PARTITION p20160513 VALUES LESS THAN (736463) ENGINE = InnoDB,
 PARTITION p20160514 VALUES LESS THAN (736464) ENGINE = InnoDB,
 PARTITION p20160515 VALUES LESS THAN (736465) ENGINE = InnoDB,
 PARTITION p20160516 VALUES LESS THAN (736466) ENGINE = InnoDB,
 PARTITION p20160517 VALUES LESS THAN (736467) ENGINE = InnoDB,
 PARTITION p20160518 VALUES LESS THAN (736468) ENGINE = InnoDB,
 PARTITION p20160519 VALUES LESS THAN (736469) ENGINE = InnoDB,
 PARTITION p20160520 VALUES LESS THAN (736470) ENGINE = InnoDB,
 PARTITION p20160521 VALUES LESS THAN (736471) ENGINE = InnoDB,
 PARTITION p20160522 VALUES LESS THAN (736472) ENGINE = InnoDB,
 PARTITION p20160523 VALUES LESS THAN (736473) ENGINE = InnoDB,
 PARTITION p20160524 VALUES LESS THAN (736474) ENGINE = InnoDB,
 PARTITION p20160525 VALUES LESS THAN (736475) ENGINE = InnoDB,
 PARTITION p20160526 VALUES LESS THAN (736476) ENGINE = InnoDB,
 PARTITION p20160527 VALUES LESS THAN (736477) ENGINE = InnoDB,
 PARTITION p20160528 VALUES LESS THAN (736478) ENGINE = InnoDB,
 PARTITION p20160529 VALUES LESS THAN (736479) ENGINE = InnoDB,
 PARTITION p20160530 VALUES LESS THAN (736480) ENGINE = InnoDB,
 PARTITION p20160531 VALUES LESS THAN (736481) ENGINE = InnoDB,
 PARTITION p20160601 VALUES LESS THAN (736482) ENGINE = InnoDB,
 PARTITION p20160602 VALUES LESS THAN (736483) ENGINE = InnoDB,
 PARTITION p20160603 VALUES LESS THAN (736484) ENGINE = InnoDB,
 PARTITION p20160604 VALUES LESS THAN (736485) ENGINE = InnoDB,
 PARTITION p20160605 VALUES LESS THAN (736486) ENGINE = InnoDB,
 PARTITION p20160606 VALUES LESS THAN (736487) ENGINE = InnoDB,
 PARTITION p20160607 VALUES LESS THAN (736488) ENGINE = InnoDB,
 PARTITION p20160608 VALUES LESS THAN (736489) ENGINE = InnoDB,
 PARTITION p20160609 VALUES LESS THAN (736490) ENGINE = InnoDB,
 PARTITION p20160610 VALUES LESS THAN (736491) ENGINE = InnoDB,
 PARTITION p20160611 VALUES LESS THAN (736492) ENGINE = InnoDB,
 PARTITION p20160612 VALUES LESS THAN (736493) ENGINE = InnoDB,
 PARTITION p20160613 VALUES LESS THAN (736494) ENGINE = InnoDB,
 PARTITION p20160614 VALUES LESS THAN (736495) ENGINE = InnoDB,
 PARTITION p20160615 VALUES LESS THAN (736496) ENGINE = InnoDB,
 PARTITION p20160616 VALUES LESS THAN (736497) ENGINE = InnoDB,
 PARTITION p20160617 VALUES LESS THAN (736498) ENGINE = InnoDB,
 PARTITION p20160618 VALUES LESS THAN (736499) ENGINE = InnoDB,
 PARTITION p20160619 VALUES LESS THAN (736500) ENGINE = InnoDB,
 PARTITION p20160620 VALUES LESS THAN (736501) ENGINE = InnoDB,
 PARTITION p20160621 VALUES LESS THAN (736502) ENGINE = InnoDB,
 PARTITION p20160622 VALUES LESS THAN (736503) ENGINE = InnoDB,
 PARTITION p20160623 VALUES LESS THAN (736504) ENGINE = InnoDB,
 PARTITION p20160624 VALUES LESS THAN (736505) ENGINE = InnoDB,
 PARTITION p20160625 VALUES LESS THAN (736506) ENGINE = InnoDB,
 PARTITION p20160626 VALUES LESS THAN (736507) ENGINE = InnoDB,
 PARTITION p20160627 VALUES LESS THAN (736508) ENGINE = InnoDB,
 PARTITION p20160628 VALUES LESS THAN (736509) ENGINE = InnoDB,
 PARTITION p20160629 VALUES LESS THAN (736510) ENGINE = InnoDB,
 PARTITION p20160630 VALUES LESS THAN (736511) ENGINE = InnoDB,
 PARTITION p20160701 VALUES LESS THAN (736512) ENGINE = InnoDB,
 PARTITION p20160702 VALUES LESS THAN (736513) ENGINE = InnoDB,
 PARTITION p20160703 VALUES LESS THAN (736514) ENGINE = InnoDB,
 PARTITION p20160704 VALUES LESS THAN (736515) ENGINE = InnoDB,
 PARTITION p20160705 VALUES LESS THAN (736516) ENGINE = InnoDB,
 PARTITION p20160706 VALUES LESS THAN (736517) ENGINE = InnoDB,
 PARTITION p20160707 VALUES LESS THAN (736518) ENGINE = InnoDB,
 PARTITION p20160708 VALUES LESS THAN (736519) ENGINE = InnoDB,
 PARTITION p20160709 VALUES LESS THAN (736520) ENGINE = InnoDB,
 PARTITION p20160710 VALUES LESS THAN (736521) ENGINE = InnoDB,
 PARTITION p20160711 VALUES LESS THAN (736522) ENGINE = InnoDB,
 PARTITION p20160712 VALUES LESS THAN (736523) ENGINE = InnoDB,
 PARTITION p20160713 VALUES LESS THAN (736524) ENGINE = InnoDB,
 PARTITION p20160714 VALUES LESS THAN (736525) ENGINE = InnoDB,
 PARTITION p20160715 VALUES LESS THAN (736526) ENGINE = InnoDB,
 PARTITION p20160716 VALUES LESS THAN (736527) ENGINE = InnoDB,
 PARTITION p20160717 VALUES LESS THAN (736528) ENGINE = InnoDB,
 PARTITION p20160718 VALUES LESS THAN (736529) ENGINE = InnoDB,
 PARTITION p20160719 VALUES LESS THAN (736530) ENGINE = InnoDB,
 PARTITION p20160720 VALUES LESS THAN (736531) ENGINE = InnoDB,
 PARTITION p20160721 VALUES LESS THAN (736532) ENGINE = InnoDB,
 PARTITION p20160722 VALUES LESS THAN (736533) ENGINE = InnoDB,
 PARTITION p20160723 VALUES LESS THAN (736534) ENGINE = InnoDB,
 PARTITION p20160724 VALUES LESS THAN (736535) ENGINE = InnoDB,
 PARTITION p20160725 VALUES LESS THAN (736536) ENGINE = InnoDB,
 PARTITION p20160726 VALUES LESS THAN (736537) ENGINE = InnoDB,
 PARTITION p20160727 VALUES LESS THAN (736538) ENGINE = InnoDB,
 PARTITION p20160728 VALUES LESS THAN (736539) ENGINE = InnoDB,
 PARTITION p20160729 VALUES LESS THAN (736540) ENGINE = InnoDB,
 PARTITION p20160730 VALUES LESS THAN (736541) ENGINE = InnoDB,
 PARTITION p20160731 VALUES LESS THAN (736542) ENGINE = InnoDB,
 PARTITION p20160801 VALUES LESS THAN (736543) ENGINE = InnoDB,
 PARTITION p20160802 VALUES LESS THAN (736544) ENGINE = InnoDB,
 PARTITION p20160803 VALUES LESS THAN (736545) ENGINE = InnoDB,
 PARTITION p20160804 VALUES LESS THAN (736546) ENGINE = InnoDB,
 PARTITION p20160805 VALUES LESS THAN (736547) ENGINE = InnoDB,
 PARTITION p20160806 VALUES LESS THAN (736548) ENGINE = InnoDB,
 PARTITION p20160807 VALUES LESS THAN (736549) ENGINE = InnoDB,
 PARTITION p20160808 VALUES LESS THAN (736550) ENGINE = InnoDB,
 PARTITION p20160809 VALUES LESS THAN (736551) ENGINE = InnoDB,
 PARTITION p20160810 VALUES LESS THAN (736552) ENGINE = InnoDB,
 PARTITION p20160811 VALUES LESS THAN (736553) ENGINE = InnoDB,
 PARTITION p20160812 VALUES LESS THAN (736554) ENGINE = InnoDB,
 PARTITION p20160813 VALUES LESS THAN (736555) ENGINE = InnoDB,
 PARTITION p20160814 VALUES LESS THAN (736556) ENGINE = InnoDB,
 PARTITION p20160815 VALUES LESS THAN (736557) ENGINE = InnoDB,
 PARTITION p20160816 VALUES LESS THAN (736558) ENGINE = InnoDB,
 PARTITION p20160817 VALUES LESS THAN (736559) ENGINE = InnoDB,
 PARTITION p20160818 VALUES LESS THAN (736560) ENGINE = InnoDB,
 PARTITION p20160819 VALUES LESS THAN (736561) ENGINE = InnoDB,
 PARTITION p20160820 VALUES LESS THAN (736562) ENGINE = InnoDB,
 PARTITION p20160821 VALUES LESS THAN (736563) ENGINE = InnoDB,
 PARTITION p20160822 VALUES LESS THAN (736564) ENGINE = InnoDB,
 PARTITION p20160823 VALUES LESS THAN (736565) ENGINE = InnoDB,
 PARTITION p20160824 VALUES LESS THAN (736566) ENGINE = InnoDB,
 PARTITION p20160825 VALUES LESS THAN (736567) ENGINE = InnoDB,
 PARTITION p20160826 VALUES LESS THAN (736568) ENGINE = InnoDB,
 PARTITION p20160827 VALUES LESS THAN (736569) ENGINE = InnoDB,
 PARTITION p20160828 VALUES LESS THAN (736570) ENGINE = InnoDB,
 PARTITION p20160829 VALUES LESS THAN (736571) ENGINE = InnoDB,
 PARTITION p20160830 VALUES LESS THAN (736572) ENGINE = InnoDB,
 PARTITION p20160831 VALUES LESS THAN (736573) ENGINE = InnoDB,
 PARTITION p20160901 VALUES LESS THAN (736574) ENGINE = InnoDB,
 PARTITION p20160902 VALUES LESS THAN (736575) ENGINE = InnoDB,
 PARTITION p20160903 VALUES LESS THAN (736576) ENGINE = InnoDB,
 PARTITION p20160904 VALUES LESS THAN (736577) ENGINE = InnoDB,
 PARTITION p20160905 VALUES LESS THAN (736578) ENGINE = InnoDB,
 PARTITION p20160906 VALUES LESS THAN (736579) ENGINE = InnoDB,
 PARTITION p20160907 VALUES LESS THAN (736580) ENGINE = InnoDB,
 PARTITION p20160908 VALUES LESS THAN (736581) ENGINE = InnoDB,
 PARTITION p20160909 VALUES LESS THAN (736582) ENGINE = InnoDB,
 PARTITION p20160910 VALUES LESS THAN (736583) ENGINE = InnoDB,
 PARTITION p20160911 VALUES LESS THAN (736584) ENGINE = InnoDB,
 PARTITION p20160912 VALUES LESS THAN (736585) ENGINE = InnoDB,
 PARTITION p20160913 VALUES LESS THAN (736586) ENGINE = InnoDB,
 PARTITION p20160914 VALUES LESS THAN (736587) ENGINE = InnoDB,
 PARTITION p20160915 VALUES LESS THAN (736588) ENGINE = InnoDB,
 PARTITION p20160916 VALUES LESS THAN (736589) ENGINE = InnoDB,
 PARTITION p20160917 VALUES LESS THAN (736590) ENGINE = InnoDB,
 PARTITION p20160918 VALUES LESS THAN (736591) ENGINE = InnoDB,
 PARTITION p20160919 VALUES LESS THAN (736592) ENGINE = InnoDB,
 PARTITION p20160920 VALUES LESS THAN (736593) ENGINE = InnoDB,
 PARTITION p20160921 VALUES LESS THAN (736594) ENGINE = InnoDB,
 PARTITION p20160922 VALUES LESS THAN (736595) ENGINE = InnoDB,
 PARTITION p20160923 VALUES LESS THAN (736596) ENGINE = InnoDB,
 PARTITION p20160924 VALUES LESS THAN (736597) ENGINE = InnoDB,
 PARTITION p20160925 VALUES LESS THAN (736598) ENGINE = InnoDB,
 PARTITION p20160926 VALUES LESS THAN (736599) ENGINE = InnoDB,
 PARTITION p20160927 VALUES LESS THAN (736600) ENGINE = InnoDB,
 PARTITION p20160928 VALUES LESS THAN (736601) ENGINE = InnoDB,
 PARTITION p20160929 VALUES LESS THAN (736602) ENGINE = InnoDB,
 PARTITION p20160930 VALUES LESS THAN (736603) ENGINE = InnoDB,
 PARTITION p20161001 VALUES LESS THAN (736604) ENGINE = InnoDB,
 PARTITION p20161002 VALUES LESS THAN (736605) ENGINE = InnoDB,
 PARTITION p20161003 VALUES LESS THAN (736606) ENGINE = InnoDB,
 PARTITION p20161004 VALUES LESS THAN (736607) ENGINE = InnoDB,
 PARTITION p20161005 VALUES LESS THAN (736608) ENGINE = InnoDB,
 PARTITION p20161006 VALUES LESS THAN (736609) ENGINE = InnoDB,
 PARTITION p20161007 VALUES LESS THAN (736610) ENGINE = InnoDB,
 PARTITION p20161008 VALUES LESS THAN (736611) ENGINE = InnoDB,
 PARTITION p20161009 VALUES LESS THAN (736612) ENGINE = InnoDB,
 PARTITION p20161010 VALUES LESS THAN (736613) ENGINE = InnoDB,
 PARTITION p20161011 VALUES LESS THAN (736614) ENGINE = InnoDB,
 PARTITION p20161012 VALUES LESS THAN (736615) ENGINE = InnoDB,
 PARTITION p20161013 VALUES LESS THAN (736616) ENGINE = InnoDB,
 PARTITION p20161014 VALUES LESS THAN (736617) ENGINE = InnoDB,
 PARTITION p20161015 VALUES LESS THAN (736618) ENGINE = InnoDB,
 PARTITION p20161016 VALUES LESS THAN (736619) ENGINE = InnoDB,
 PARTITION p20161017 VALUES LESS THAN (736620) ENGINE = InnoDB,
 PARTITION p20161018 VALUES LESS THAN (736621) ENGINE = InnoDB,
 PARTITION p20161019 VALUES LESS THAN (736622) ENGINE = InnoDB,
 PARTITION p20161020 VALUES LESS THAN (736623) ENGINE = InnoDB,
 PARTITION p20161021 VALUES LESS THAN (736624) ENGINE = InnoDB,
 PARTITION p20161022 VALUES LESS THAN (736625) ENGINE = InnoDB,
 PARTITION p20161023 VALUES LESS THAN (736626) ENGINE = InnoDB,
 PARTITION p20161024 VALUES LESS THAN (736627) ENGINE = InnoDB,
 PARTITION p20161025 VALUES LESS THAN (736628) ENGINE = InnoDB,
 PARTITION p20161026 VALUES LESS THAN (736629) ENGINE = InnoDB,
 PARTITION p20161027 VALUES LESS THAN (736630) ENGINE = InnoDB,
 PARTITION p20161028 VALUES LESS THAN (736631) ENGINE = InnoDB,
 PARTITION p20161029 VALUES LESS THAN (736632) ENGINE = InnoDB,
 PARTITION p20161030 VALUES LESS THAN (736633) ENGINE = InnoDB,
 PARTITION p20161031 VALUES LESS THAN (736634) ENGINE = InnoDB,
 PARTITION p20161101 VALUES LESS THAN (736635) ENGINE = InnoDB,
 PARTITION p20161102 VALUES LESS THAN (736636) ENGINE = InnoDB,
 PARTITION p20161103 VALUES LESS THAN (736637) ENGINE = InnoDB,
 PARTITION p20161104 VALUES LESS THAN (736638) ENGINE = InnoDB,
 PARTITION p20161105 VALUES LESS THAN (736639) ENGINE = InnoDB,
 PARTITION p20161106 VALUES LESS THAN (736640) ENGINE = InnoDB,
 PARTITION p20161107 VALUES LESS THAN (736641) ENGINE = InnoDB,
 PARTITION p20161108 VALUES LESS THAN (736642) ENGINE = InnoDB,
 PARTITION p20161109 VALUES LESS THAN (736643) ENGINE = InnoDB,
 PARTITION p20161110 VALUES LESS THAN (736644) ENGINE = InnoDB,
 PARTITION p20161111 VALUES LESS THAN (736645) ENGINE = InnoDB,
 PARTITION p20161112 VALUES LESS THAN (736646) ENGINE = InnoDB,
 PARTITION p20161113 VALUES LESS THAN (736647) ENGINE = InnoDB,
 PARTITION p20161114 VALUES LESS THAN (736648) ENGINE = InnoDB,
 PARTITION p20161115 VALUES LESS THAN (736649) ENGINE = InnoDB,
 PARTITION p20161116 VALUES LESS THAN (736650) ENGINE = InnoDB,
 PARTITION p20161117 VALUES LESS THAN (736651) ENGINE = InnoDB,
 PARTITION p20161118 VALUES LESS THAN (736652) ENGINE = InnoDB,
 PARTITION p20161119 VALUES LESS THAN (736653) ENGINE = InnoDB,
 PARTITION p20161120 VALUES LESS THAN (736654) ENGINE = InnoDB,
 PARTITION p20161121 VALUES LESS THAN (736655) ENGINE = InnoDB,
 PARTITION p20161122 VALUES LESS THAN (736656) ENGINE = InnoDB,
 PARTITION p20161123 VALUES LESS THAN (736657) ENGINE = InnoDB,
 PARTITION p20161124 VALUES LESS THAN (736658) ENGINE = InnoDB,
 PARTITION p20161125 VALUES LESS THAN (736659) ENGINE = InnoDB,
 PARTITION p20161126 VALUES LESS THAN (736660) ENGINE = InnoDB,
 PARTITION p20161127 VALUES LESS THAN (736661) ENGINE = InnoDB,
 PARTITION p20161128 VALUES LESS THAN (736662) ENGINE = InnoDB,
 PARTITION p20161129 VALUES LESS THAN (736663) ENGINE = InnoDB,
 PARTITION p20161130 VALUES LESS THAN (736664) ENGINE = InnoDB,
 PARTITION p20161201 VALUES LESS THAN (736665) ENGINE = InnoDB,
 PARTITION p20161202 VALUES LESS THAN (736666) ENGINE = InnoDB,
 PARTITION p20161203 VALUES LESS THAN (736667) ENGINE = InnoDB,
 PARTITION p20161204 VALUES LESS THAN (736668) ENGINE = InnoDB,
 PARTITION p20161205 VALUES LESS THAN (736669) ENGINE = InnoDB,
 PARTITION p20161206 VALUES LESS THAN (736670) ENGINE = InnoDB,
 PARTITION p20161207 VALUES LESS THAN (736671) ENGINE = InnoDB,
 PARTITION p20161208 VALUES LESS THAN (736672) ENGINE = InnoDB,
 PARTITION p20161209 VALUES LESS THAN (736673) ENGINE = InnoDB,
 PARTITION p20161210 VALUES LESS THAN (736674) ENGINE = InnoDB,
 PARTITION p20161211 VALUES LESS THAN (736675) ENGINE = InnoDB,
 PARTITION p20161212 VALUES LESS THAN (736676) ENGINE = InnoDB,
 PARTITION p20161213 VALUES LESS THAN (736677) ENGINE = InnoDB,
 PARTITION p20161214 VALUES LESS THAN (736678) ENGINE = InnoDB,
 PARTITION p20161215 VALUES LESS THAN (736679) ENGINE = InnoDB,
 PARTITION p20161216 VALUES LESS THAN (736680) ENGINE = InnoDB,
 PARTITION p20161217 VALUES LESS THAN (736681) ENGINE = InnoDB,
 PARTITION p20161218 VALUES LESS THAN (736682) ENGINE = InnoDB,
 PARTITION p20161219 VALUES LESS THAN (736683) ENGINE = InnoDB,
 PARTITION p20161220 VALUES LESS THAN (736684) ENGINE = InnoDB,
 PARTITION p20161221 VALUES LESS THAN (736685) ENGINE = InnoDB,
 PARTITION p20161222 VALUES LESS THAN (736686) ENGINE = InnoDB,
 PARTITION p20161223 VALUES LESS THAN (736687) ENGINE = InnoDB,
 PARTITION p20161224 VALUES LESS THAN (736688) ENGINE = InnoDB,
 PARTITION p20161225 VALUES LESS THAN (736689) ENGINE = InnoDB,
 PARTITION p20161226 VALUES LESS THAN (736690) ENGINE = InnoDB,
 PARTITION p20161227 VALUES LESS THAN (736691) ENGINE = InnoDB,
 PARTITION p20161228 VALUES LESS THAN (736692) ENGINE = InnoDB,
 PARTITION p20161229 VALUES LESS THAN (736693) ENGINE = InnoDB,
 PARTITION p20161230 VALUES LESS THAN (736694) ENGINE = InnoDB,
 PARTITION p20161231 VALUES LESS THAN (736695) ENGINE = InnoDB,
 PARTITION pMax VALUES LESS THAN MAXVALUE ENGINE = InnoDB);

-- ----------------------------
-- Table structure for ip_map
-- ----------------------------
DROP TABLE IF EXISTS `ip_map`;
CREATE TABLE `ip_map` (
  `ip_addr` int(20) unsigned NOT NULL,
  `country` varchar(10) NOT NULL,
  `stateprov` varchar(100) NOT NULL,
  `city` varchar(100) NOT NULL,
  `latitude` float NOT NULL,
  `longitude` float NOT NULL,
  `timezone_offset` varchar(10) NOT NULL,
  `timezone_name` varchar(100) NOT NULL,
  `isp_name` varchar(100) NOT NULL,
  `connection_type` varchar(100) NOT NULL,
  `organization_name` varchar(100) NOT NULL,
  PRIMARY KEY (`ip_addr`),
  KEY `ip_map_country_idx` (`country`),
  KEY `ip_map_lat_long_idx` (`latitude`,`longitude`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for monthly_event_aggregation
-- ----------------------------
DROP TABLE IF EXISTS `monthly_event_aggregation`;
CREATE TABLE `monthly_event_aggregation` (
  `date` date NOT NULL,
  `sid` int(11) NOT NULL,
  `ip_src` int(20) unsigned NOT NULL,
  `ip_dst` int(20) unsigned NOT NULL,
  `signature` int(5) NOT NULL,
  `signature_name` varchar(100) NOT NULL,
  `signature_priority` int(2) NOT NULL,
  `protocol` int(5) NOT NULL,
  `s_port` int(11) NOT NULL,
  `d_port` int(11) NOT NULL,
  `counter` int(21) unsigned NOT NULL,
  UNIQUE KEY `monthly_event_aggregation_idx` (`date`,`sid`,`ip_src`,`ip_dst`,`signature`,`signature_name`,`signature_priority`,`protocol`,`s_port`,`d_port`,`counter`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for sensor
-- ----------------------------
DROP TABLE IF EXISTS `sensor`;
CREATE TABLE `sensor` (
  `sid` int(10) NOT NULL AUTO_INCREMENT,
  `hostname` varchar(255) NOT NULL,
  `interface` varchar(255) NOT NULL,
  `ip_address` varchar(255) NOT NULL,
  `location` varchar(255) DEFAULT NULL,
  `company` varchar(255) DEFAULT NULL,
  `snort_service` int(11) DEFAULT NULL,
  `barnyard2_service` int(11) DEFAULT NULL,
  `mysql_service` int(11) DEFAULT NULL,
  `push_status` int(11) DEFAULT NULL,
  `push_permission` int(11) DEFAULT NULL,
  PRIMARY KEY (`sid`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for sensor_push_log
-- ----------------------------
DROP TABLE IF EXISTS `sensor_push_log`;
CREATE TABLE `sensor_push_log` (
  `id` int(100) unsigned NOT NULL AUTO_INCREMENT,
  `sid` int(11) NOT NULL,
  `job_start` datetime NOT NULL,
  `job_end` datetime DEFAULT NULL,
  `range_start` datetime DEFAULT NULL,
  `range_end` datetime DEFAULT NULL,
  `first_cid` int(20) unsigned DEFAULT NULL,
  `last_cid` int(20) unsigned DEFAULT NULL,
  `package_name` varchar(255) DEFAULT NULL,
  `extract_status` int(2) DEFAULT NULL,
  `agregation_status` int(2) DEFAULT '0',
  `count_event` int(11) unsigned DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `sensor_push_log_idx` (`sid`,`job_start`,`count_event`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;